# 20231224155020 Video Note: Belajar OpenAPI

#HTML

```
author: Eko Kurniawan Khannedy
location: Programmer Zaman Now <https://youtu.be/o5b6TYSNK5c>
date: 2021-08-12
```

[toc]

## Sebelum Belajar

* [[20231021214554]]
* [[20231126204229]]

## 01 Pengenalan OpenAPI

* OpenAPI merupakan **standar spesifikasi**, tidak tergantung bahasa pemrograman apapun, untuk membuat dokumentasi RESTful API
* OpenAPI dibuat agar pengguna RESTful API tidak perlu mengakses kode aplikasi dan membaca dokumen manual (misal dalam bentuk doc, pdf) untuk memahami RESTful API yang dibuat
* OpenAPI bisa menggunakan tool untuk menampilkan secara visual, bahkan untuk membuat kode program Client atau Server
* <https://www.openapis.org>
* <https://github.com/OAI/OpenAPI-Specification>
* <https://swagger.io/specification>

### Document Structure

* OpenAPI memiliki struktur document yang sudah standar
* Namun kita diberi dua opsi untuk membuat document nya, bisa menggunakan JSON atau YAML
* <https://www.json.org>
* <https://yaml.org>

### OpenAPI Editor

* Document OpenAPI hanya menggunakan JSON atau Yaml, jadi untuk membuat document OpenAPI kita cukup menggunakan Text Editor
* Namun jika kita ingin melihat OpenAPI dalam bentuk Visual, kita juga bisa menggunakan Swagger Editor: <https://editor.swagger.io>
* Jika menggunakan product JetBrains, bisa menggunakan plugin OpenAPI
  <https://www.jetbrains.com/help/idea/openapi.html>
* Jika menggunakan VS Code, bisa menggunakan plugin OpenAPI
  <https://marketplace.visualstudio.com/items?itemName=42Crunch.vscode-openapi>


## 02 Tipe Data

* Saat kita membuat RESTful API, sudah dipastikan kita akan membuat request dan response, dimana dalam data request dan response sudah dipastikan terdapat detail data
* Misal, jika terdapat data Product, pasti ada `id`, `name`, `price`, dan lain-lain
* Semua detail data tersebut pasti memiliki tipe data
* Kita tidak bisa menggunakan tipe data yang terdapat pada bahasa pemrograman yang digunakan untuk membuat RESTful API, oleh karena itu, pada OpenAPI terdapat tipe data general yang bisa digunakan, yang dapat dimengerti di semua bahasa pemrograman
* <https://spec.openapis.org/oas/v3.0.3#data-types>

### OpenAPI Tipe Data

| type    | format    | Comments                         |
|---------|-----------|----------------------------------|
| integer | int32     | signed 32 bits                   |
| integer | int64     | signed 64 bits (a.k.a long)      |
| number  | float     |                                  |
| number  | double    |                                  |
| string  |           |                                  |
| string  | byte      | base64 encoded characters        |
| string  | binary    | any sequence of octets           |
| boolean |           |                                  |
| string  | date      | As defined by full-date-RFC3339  |
| string  | date-time | As defined by date-time-RFC3339  |
| string  | password  | As hint to UIs to obsscure input |


## 03 Document

* OpenAPI sangatlah sederhana, kita hanya perlu membuat satu file berisi semua data OpenAPI nya
* OpenAPI memiliki struktur yang sudah ditentukan ketika membuat document nya
* Kita bisa menggunakan JSON atau YAML untuk file nya
* <https://spec.openapis.org/oas/v3.0.3#openapi-object>

### OpenAPI Object

| Field Name   | Type                          |          |
|--------------|-------------------------------|----------|
| openapi      | string                        | REQUIRED |
| info         | Info Object                   | REQUIRED |
| servers      | Server Object                 | REQUIRED |
| paths        | Paths Object                  | REQUIRED |
| components   | Components Object             |          |
| security     | Security Requirement Object   |          |
| tags         | Tag Object                    |          |
| externalDocs | External Documentation Object |          |

### Kode: OpenAPI Document

```json
{
  "openapi": "3.0.3",
  "info": {},
  "servers": [],
  "paths": {}
}
```

## 04 Info

* Info merupakan bagian dari informasi metadata tentang API yang kita buat
* Kita bisa memasukkan author, lisensi, dan lain-lain
* <https://spec.openapis.org/oas/v3.0.3#info-object>

### Info Object

| Field Name     | Type           |          |
|----------------|----------------|----------|
| title          | string         | REQUIRED |
| description    | string         |          |
| termsOfService | string         |          |
| contact        | Contact Object |          |
| license        | License Object |          |
| version        | string         | REQUIRED |

#### Contact Object

| Field Name | Type   |
|------------|--------|
| name       | string |
| url        | string |
| email      | string |

#### License Object

| Field Name | Type   |          |
|------------|--------|----------|
| name       | string | REQUIRED |
| url        | string |          |

### Kode: Info

```json
{
  "openapi": "3.0.3",
  "info": {
    "title": "TodoList RESTful API",
    "description": "OpenAPI for TodoList RESTful API",
    "version": "1",
    "contact": {
      "name": "Eko Kurniawan Khannedy",
      "email": "echo.khannedy@gmail.com",
      "url": "https://www.programmerzamannow.com"
    },
    "license": {
      "name": "APACHE 2.0",
      "url": "https://www.apache.org/licenses/LICENSE-2.0"
    }
  },
  "servers": [],
  "paths": {}
}
```


## 05 Server

* Saat kita membuat API sudah pasti terdapat Server RESTful API yang nanti akan kita buat
* Kita bisa memberitahu Server yang tersedia di OpenAPI
* Misal, terdapat Server development, staging, production dan lain-lain
* <https://spec.openapis.org/oas/v3.0.3#server-object>

### Server Object

| Field Name | Type                                |          |
|------------|-------------------------------------|----------|
| url        | string                              | REQUIRED |
| desciption | string                              |          |
| variables  | Map[string, Server Variable Object] |          |

### Kode: Sever

```json
{
  "openapi": "3.0.3",
  "info": {},
  "servers": [
    {
      "url": "https://{environment}.programmerzamannow.com/api/v1",
      "description": "TodoList RESTful API Server",
      "variables": {
        "environment": {
          "default": "development",
          "description": "Server Environment",
          "enum": [
            "development",
            "staging",
            "production"
          ]
        }
      }
    }
  ],
  "paths": {}
}
```


## 06 External Documentation

* External documentation merupakan bagian dalam OpenAPI jika kita ingin menambahkan link tambahan dalam OpenAPI
* Bisa menuju link documentation lain, atau mungkin link menuju website
* <https://spec.openapis.org/oas/v3.0.3#external-documentation-object>

### External Documentation Object

| Field Name  | Type   |          |
|-------------|--------|----------|
| description | string |          |
| url         | string | REQUIRED |


### Kode: External Documentation

```json
{
  "openapi": "3.0.3",
  "info": {},
  "servers": [],
  "externalDocs": {
    "description": "Youtube Programmer Zaman Now",
    "url": "https://www.youtube.com/c/ProgrammerZamanNow"
  },
  "paths": {}
}
```


## 07 Paths

* Paths merupakan representasi endpoint API di OpenAPI
* Pada Paths, kita tidak perlu menuliskan seluruh URL, cukup URL di belakang setelah lokasi Server
* <https://spec.openapis.org/oas/v3.0.3#paths-object>

### Paths Object

| Field Name | Type             |
|------------|------------------|
| /{path}    | Path Item Object |

### Paths Item Object

| Field Name  | Type                               |
|-------------|------------------------------------|
| $ref        | string                             |
| summary     | string                             |
| description | string                             |
| servers     | Server Object                      |
| parameters  | Parameter Object, Reference Object |

### Paths Operation

| Field Name | Type             | Description                                       |
|------------|------------------|---------------------------------------------------|
| get        | Operation Object | A definition of a GET operation on this path.     |
| put        | Operation Object | A definition of a PUT operation on this path.     |
| post       | Operation Object | A definition of a POST operation on this path.    |
| delete     | Operation Object | A definition of a DELETE operation on this path.  |
| options    | Operation Object | A definition of a OPTIONS operation on this path. |
| head       | Operation Object | A definition of a HEAD operation on this path.    |
| patch      | Operation Object | A definition of a PATCH operatoin on this path.   |
| trace      | Operation Object | A definition of a TRACE operation on this path.   |


### Kode: Paths

```json
{
  "openapi": "3.0.3",
  "info": {},
  "servers": [],
  "externalDocs": {},
  "paths": {
    "/todolist": {
      "get": {},
      "post": {}
    },
    "/todolist/{todolistId}": {
      "delete": {},
      "put": {},
    }
  }
}
```


## 08 Operation

* Setiap Path yang kita buat di OpenAPI, bisa memiliki lebih dari satu Operation
* Hal ini dikarenakan, dalam HTTP, satu URL bisa memiliki beberapa HTTP Method
* Misal, URL untuk mengambil semua data danmembuat data baru, mungkin URL nya sama. Yang membedakan adalah HTTP Method nya. GET untuk mengambil data, POST untuk membuat data
* Inti dari API Documentation adalah dokumentasi operation yang terdapat pada RESTful API yang kita buat
* <https://spec.openapis.org/oas/v3.0.3#operation-object>

### Operation Object

| Field Name   | Type                                   |          |
|--------------|----------------------------------------|----------|
| tags         | [string]                               |          |
| summary      | string                                 |          |
| description  | string                                 |          |
| externalDocs | External Documentation Object          |          |
| operationId  | string                                 |          |
| parameters   | [Parameter Object, Reference Object]   |          |
| requestBody  | Request Body                           |          |
|              | Reference Object                       |          |
| responses    | Responses Object                       | REQUIRED |
| callbacks    | Map[string, Callback Object Reference] |          |
| deprecated   | boolean                                |          |
| security     | [Security Requirement Object]          |          |
| servers      | [Server Object]                        |          |


### Kode: Operation

```json
{
  "openapi": "3.0.3",
  "info": {},
  "servers": [],
  "externalDocs": {},
  "paths": {
    "/todolist": {
      "get": {
        "summary": "Get all todolist",
        "description": "Get all active todolist by default",
        "responses": {}
      },
      "post": {
        "summary": "Create new todolist",
        "description": "Create new active todolist",
        "responses": {}
      }
    },
    "/todolist/{todolistId}": {
      "put": {
        "summary": "Update existing todolist",
        "description": "Update existing todolist in database",
        "responses": {}
      },
      "delete": {
        "summary": "Delete existing todolist",
        "description": "Delete existing todolist in database",
        "responses": {}
      }
    }
  }
}
```


## 09 Parameter

* Parameter adalah data yang dikirim tidak melalui Request Body
* Operation bisa memiliki parameter lebih dari satu
* OpenAPI mendukung beberapa jenis parameter, yaitu Query Parameter, Path Variable, Header, dan Cookie
* Kita bisa menambahkan parameter pada Operation, sehingga pengguna bisa tahu bahwa ada parameter yang perlu dikirim ketika memanggil Operation tersebut
* <https://spec.openapis.org/oas/v3.0.3#parameter-object>

### Parameter Object

| Field Name      | Type    |          |
|-----------------|---------|----------|
| name            | string  | REQUIRED |
| in              | string  | REQUIRED |
| description     | string  |          |
| required        | boolean |          |
| deprecated      | boolean |          |
| allowEmptyValue | boolean |          |

### Kode: Parameter

```json
{
  "openapi": "3.0.3",
  "info": {},
  "servers": [],
  "externalDocs": {},
  "paths": {
    "/todolist": {
      "get": {
        "summary": "Get all todolist",
        "description": "Get all active todolist by default",
        "parameters": [
          {
            "name": "include_done",
            "in": "query",
            "required": false,
            "description": "Include done todolist in the result"
          },
          {
            "name": "name",
            "in": "query",
            "required": false,
            "description": "Search todolist by name"
          }
        ],
        "responses": {}
      },
      "post": {
        "summary": "Create new todolist",
        "description": "Create new active todolist",
        "responses": {}
      }
    },
    "/todolist/{todolistId}": {
      "put": {
        "summary": "Update existing todolist",
        "description": "Update existing todolist in database",
        "parameters": [
          {
            "name": "todolistId",
            "in": "path",
            "required": true,
            "description": "Todolist Id for update"
          }
        ],
        "responses": {}
      },
      "delete": {
        "summary": "Delete existing todolist",
        "description": "Delete existing todolist in database",
        "parameters": [
          {
            "name": "todolistId",
            "in": "path",
            "required": true,
            "description": "Todolist Id for delete"
          }
        ],
        "responses": {}
      }
    }
  }
}
```


## 10 Schema

* Saat kita membuat parameter, kita mungkin ingin memberitahu tentang tipe data untuk parameter tersebut
* Parameter memiliki attribute bernama schema, dimana schema sebenarnya sangat kompleks, kita akan bahas secara bertahap
* Dimulai dari simple schema, misal tipe data yang sebelumnya sudah kita bahas

### JSON Schema Specification

* Schema menggunakan JSON Schema untuk mendefinisikan struktur datanya
* JSON Schema bisa berisikan tipe sederhana, seperti number, string, boolean, dan lain-lain, atau bahkan tipe data kompleks, seperti object dan array
* <https://json-schema.org>
* <https://json-schema.org/draft/2020-12/json-schema-core.html>

### Kode: Schema

```json
{
  "name": "include_done",
  "in": "query",
  "required": false,
  "description": "Include done todolist in the result",
  "schema": {
    "type": "boolean"
  }
}
```

### JSON Schema Validation

* Schema mendukung JSON Schema Validation
* Hal ini membuat kita bisa memberitahu validasi yang diperlukan ketika pengguna membaca OpenAPI kita
* Dengan kita tambahkan Schema Validation, pengguna RESTful API kita bisa tahu validation yang kita buat tanpa harus kita buat dokumentasi secara terpisah
* <https://json-schema.org/draft/2020-12/json-schema-validation.html>

### Kode: Schema Validation

```json
{
  "name": "name",
  "in": "query",
  "required": false,
  "description": "Search todolist by name",
  "schema": {
    "type": "string",
    "nullable": true,
    "maxLength": 100,
    "minLength": 1
  }
}
```


## 11 Request Body

* OpenAPI juga mendukung dokumentasi untuk request body
* Dengan ini, kita memberi tahu tentang schema request body yang harus dikirim ketika menggunakan RESTful API kita
* Request Body mendukung schema, sehingga kita memberi tahu bentuk schema format data, bahkan validasi yang diperlukan
* <https://spec.openapis.org/oas/v3.0.3#request-body-object>

### Request Body Object

| Field Name  | Type                           |          |
|-------------|--------------------------------|----------|
| description | string                         |          |
| content     | Map[string, Media Type Object] | REQUIRED |
| required    | boolean                        |          |

### Media Type Object

| Field Name | Type                                          |
|------------|-----------------------------------------------|
| schema     | Schema Object, Reference Object               |
| example    | Any                                           |
| examples   | Map[string, Example Object, Reference Object] |
| encoding   | Map[string, Encoding Object]                  |

### Kode: Request Body

```json
{
  "requestBody": {
    "required": true,
    "content": {
      "application/json": {
        "schema": {}
      }
    }
  }
}
```


## 12 Object Schema

* Sebelumnya kita hanya membuat schema sederhana, seperti schema tipe data boolean atau string
* Spesifikasi di JSON Schema juga mendukung pembuatan schema berupa object, yaitu data yang memiliki attribute lebih dari satu
* <https://spec.openapis.org/oas/v3.0.3#schema-object>

### Kode: Object Schema

```json
{
  "requestBody": {
    "required": true,
    "content": {
      "application/json": {
        "schema": {
          "type": "object",
          "properties": {
            "name": {
              "type": "string",
              "required": true,
              "minLength": 1
            },
            "priority": {
              "type": "integer",
              "format": "int32",
              "required": true,
              "default": 1
            }
          }
        }
      }
    }
  }
}
```


## 13 Array Schema

* Selain tipe data object, Schema juga mendukung tipe data array
* Saat membuat tipe data array, kita juga bisa menentukan tipe data items yang terdapat di array, bisa tipe data sederhana, bisa tipe data kompleks seperti object atau array lagi
* <https://spec.openapis.org/oas/v3.0.3#xml-arrays>

### Kode: Array Schema

```json
{
  "requestBody": {
    "required": true,
    "content": {
      "application/json": {
        "schema": {
          "type": "object",
          "properties": {
            "name": {
              "type": "string",
              "required": true,
              "minLength": 1
            },
            "priority": {
              "type": "integer",
              "format": "int32",
              "required": true,
              "default": 1
            },
            "tags": {
              "type": "array",
              "required": false,
              "minItems": 1,
              "items": {
                "type": "string",
                "minLength": 1
              }
            }
          }
        }
      }
    }
  }
}
```


## 14 Example

* OpenAPI mendukung example data
* Example data merupakan data contoh yang bisa kita tambahkan baik itu di Parameter, Request Body, dan Response Body
* <https://spec.openapis.org/oas/v3.0.3#example-object>

### Kode: Example

```json
{
  "parameters": [
    {
      "name": "include_done",
      "in": "query",
      "required": false,
      "description": "Include done todolist in the result",
      "schema": {
        "type": "boolean",
        "default": false,
        "nullable": true
      }
    },
    {
      "name": "name",
      "in": "query",
      "required": false,
      "description": "Search todolist by name",
      "schema": {
        "type": "string",
        "nullable": true,
        "maxLength": 100,
        "minLength": 1
      },
      "examples": {
        "java": {
          "description": "Example name Java",
          "value": "Java"
        },
        "php": {
          "description": "Example name PHP",
          "value": "PHP"
        }
      }
    }
  ]
}
```

### Kode: Example di Request Body

```json
{
  "requestBody": {
    "required": true,
    "content": {
      "application/json": {
        "schema": {
          "type": "object",
          "properties": {
            "name": {
              "type": "string",
              "required": true,
              "minLength": 1
            },
            "priority": {
              "type": "integer",
              "format": "int32",
              "required": true,
              "default": 1
            },
            "tags": {
              "type": "array",
              "required": false,
              "minItems": 1,
              "items": {
                "type": "string",
                "minLength": 1
              }
            }
          }
        },
        "examples": {
          "java": {
            "description": "Example create todolist Java",
            "value": {
              "name": "Belajar Pemrograman Java",
              "priority": 3,
              "tags": ["Java", "Pemrograman"]
            }
          },
          "php": {
            "description": "Example create todolist PHP",
            "value": {
              "name": "Belajar Pemrograman PHP",
              "priority": 2,
              "tags": ["PHP", "Pemrograman"]
            }
          }
        }
      }
    }
  }
}
```


## 15 Response Body

* Selain Request Body, kita juga mendokumentasikan Response Body di OpenAPI
* Dengan demikian, kita bisa memberi tahu format Response Body yang kita kembalikan pada RESTful API yang kita buat
* Yang menarik di OpenAPI, kita bisa memberi tahu format Response Body sesuai dengan Response Status nya, misal kita bisa tentukan untuk Response Status 200, 400, 500, dan lain-lain
* <https://spec.openapis.org/oas/v3.0.3#responses-object>
* <https://spec.openapis.org/oas/v3.0.3#patterned-fields-0>
* <https://spec.openapis.org/oas/v3.0.3#response-object>

### Response Body Object

| Field Name       | Type                               |
|------------------|------------------------------------|
| HTTP Status Code | Response Object / Reference Object |

### Response Object

| Field Name  | Type                                         |          |
|-------------|----------------------------------------------|----------|
| description | String                                       | REQUIRED |
| headers     | Map[string, Header Object, Reference Object] |          |
| content     | Map[string, Media Type Object]               |          |
| links       | Map[string, Link Object, Reference Object]   |          |

### Kode: Response Body

```json
{
  "responses": {
    "200": {
      "description": "Success get all todolist",
      "content": {
        "application/json": {
          "schema": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "string"
                },
                "name": {
                  "type": "string"
                },
                "prioity": {
                  "type": "number",
                  "format": "int32"
                },
                "tags": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "examples": {
            "success": {
              "description": "Example success get all todolist",
              "value": [
                {
                  "id": "1",
                  "name": "Java",
                  "priority": 3,
                  "tags": [
                    "Java",
                    "Pemrograman"
                  ]
                },
                {
                  "id": "2",
                  "name": "PHP",
                  "priority": 2,
                  "tags": [
                    "PHP",
                    "Pemrograman"
                  ]
                }
              ]
            }
          }
        }
      }
    },
    "201": {
      "description": "Success create todolist",
      "content": {
        "application/json": {
          "schema": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              },
              "name": {
                "type": "string"
              },
              "prioity": {
                "type": "number",
                "format": "int32"
              },
              "tags": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            }
          },
          "examples": {
            "java": {
              "description": "Success create Java todolist",
              "value": {
                "id": "1",
                "name": "Java",
                "priority": 3,
                "tags": [
                  "Java",
                  "Pemrograman"
                ]
              }
            },
            "php": {
              "description": "Success create PHP todolist",
              "value": {
                "id": "2",
                "name": "PHP",
                "priority": 2,
                "tags": [
                  "PHP",
                  "Pemrograman"
                ]
              }
            }
          }
        }
      }
    },
    "202": {
      "description": "Update todolist success",
      "content": {
        "application/json": {
          "schema": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              },
              "name": {
                "type": "string"
              },
              "prioity": {
                "type": "number",
                "format": "int32"
              },
              "tags": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            }
          },
          "examples": {
            "java": {
              "description": "Success update Java todolist",
              "value": {
                "id": "1",
                "name": "Java",
                "priority": 3,
                "tags": [
                  "Java",
                  "Pemrograman"
                ]
              }
            },
            "php": {
              "description": "Success update PHP todolist",
              "value": {
                "id": "2",
                "name": "PHP",
                "priority": 2,
                "tags": [
                  "PHP",
                  "Pemrograman"
                ]
              }
            }
          }
        }
      }
    },
    "204": {
      "description": "Delete todolist success",
      "content": {
        "application/json": {
          "schema": {
            "type": "object",
            "properties": {
              "success": {
                "type": "boolean"
              }
            }
          },
          "examples": {
            "success": {
              "description": "Success delete todolist",
              "value": {
                "success": true
              }
            }
          }
        }
      }
    },
    "404": {
      "description": "Failed not found todolist",
      "content": {
        "application/json": {
          "schema": {
            "type": "object",
            "properties": {
              "success": {
                "type": "boolean"
              }
            }
          },
          "examples": {
            "failed": {
              "description": "Failed delete todolist",
              "value": {
                "success": false
              }
            }
          }
        }
      }
    }
  }
}
```


## 16 Tag

* Tag merupakan fitur tambahan, dimana kita bisa grouping beberapa Path menjadi satu Tag yang sama
* Misal, ketika kitamembuat OpenAPI untuk RESTful API Toko Online, kita grouping dengan Tag Product, Customer, Payment, Order, dan lain-lain

### Kode: Tag

```json
{
  "openapi": "3.0.3",
  "info": {},
  "servers": [],
  "externalDocs": {},
  "paths": {
    "/todolist": {
      "get": {
        "tags": ["Todolist"],
        "summary": "Get all todolist",
        "description": "Get all active todolist by default",
        "parameters": [],
        "responses": {}
      },
      "post": {
        "tags": ["Todolist"],
        "summary": "Create new todolist",
        "description": "Create new active todolist",
        "requestBody": {},
        "responses": {}
      }
    },
    "/todolist/{todolistId}": {
      "put": {
        "tags": ["Todolist"],
        "summary": "Update existing todolist",
        "description": "Update existing todolist in database",
        "parameters": [],
        "requestBody": {},
        "responses": {}
      },
      "delete": {
        "tags": ["Todolist"],
        "summary": "Delete existing todolist",
        "description": "Delete existing todolist in database",
        "parameters": [],
        "responses": {}
      }
    }
  }
}
```


## 17 Component

* Component merupakan bagian dalam OpenAPI untuk menyimpan object yang bisa digunakan ulang
* Misal, saat nanti kita membuat spek untuk Request Body atau Response Body, dibandingkan kita buat satu persatu, jika ada beberapa yang sama, lebih baik kita buat dalam Component, sehingga bisa digunakan di beberapa Endpoint API
* Ada banyak jenis Component, ada Schema, Request, Response, Parameter, dan lain-lain
* <https://spec.openapis.org/oas/v3.0.3#components-object>

### Component Object

| Field Name      | Type                                                  |
|-----------------|-------------------------------------------------------|
| schemas         | Map[string, Schema Object, Reference Object]          |
| responses       | Map[string, Response Object, Reference Object]        |
| parameters      | Map[string, Parameter Object, Reference Object]       |
| examples        | Map[string, Example Object, Reference Object]         |
| requestBodies   | Map[string, Request Body Object, Reference Object]    |
| headers         | Map[string, Header Object, Reference Object]          |
| securitySchemes | Map[string, Security Scheme Object, Reference Object] |
| links           | Map[string, Link Object, Reference Object]            |
| callbacks       | Map[string, Callback Object, Reference Object]        |

### Kode: Component

```json
{
  "openapi": "3.0.3",
  "info": {},
  "servers": [],
  "externalDocs": {},
  "paths": {},
  "components": {
    "parameters": {
      "TodolistId": {
        "name": "todolistId",
        "in": "path",
        "required": true,
        "description": "Todolist Id for update",
        "schema": {
          "type": "string",
          "maxLength": 100,
          "minLength": 1
        },
        "examples": {
          "java": {
            "description": "Sample todolist Id for Java",
            "value": "1"
          },
          "php": {
            "description": "Sample todolist Id for PHP",
            "value": "2"
          }
        }
      }
    },
    "schemas": {
      "Todolist": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "prioity": {
            "type": "number",
            "format": "int32"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "CreateOrUpdateTodolist": {
        "type": "object",
        "required": ["name", "priority"],
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "default": 1
          },
          "tags": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "string",
              "minLength": 1
            }
          }
        }
      },
      "ArrayTodolist": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string"
            },
            "name": {
              "type": "string"
            },
            "prioity": {
              "type": "number",
              "format": "int32"
            },
            "tags": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        }
      }
    }
  }
}
```


## 18 Reference Schema

### Reference

* OpenAPI memiliki fitur reference, dimana dengan reference kita bisa membuat reference ke data component yang sudah kita buat
* Hal ini lebih baik, daripada kita buat component yang sama bekali-kali pada beberapa path, misal jika terdapat Response Body yang sama, lebih baik kita gunakan reference, jika memiliki parameter yang sama, lebih baik kita gunakan reference
* <https://spec.openapis.org/oas/v3.0.3#reference-object>

### Kode: Reference

```json
{
  "openapi": "3.0.3",
  "info": {},
  "servers": [],
  "externalDocs": {},
  "paths": {
    "/todolist": {
      "get": {
        "tags": ["Todolist"],
        "summary": "Get all todolist",
        "description": "Get all active todolist by default",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Success get all todolist",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ArrayTodolist"
                },
                "examples": {
                  "success": {
                    "description": "Example success get all todolist",
                    "value": [
                      {
                        "id": "1",
                        "name": "Java",
                        "priority": 3,
                        "tags": [
                          "Java",
                          "Pemrograman"
                        ]
                      },
                      {
                        "id": "2",
                        "name": "PHP",
                        "priority": 2,
                        "tags": [
                          "PHP",
                          "Pemrograman"
                        ]
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Todolist"],
        "summary": "Create new todolist",
        "description": "Create new active todolist",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateOrUpdateTodolist"
              },
              "examples": {
                "java": {
                  "description": "Example create todolist Java",
                  "value": {
                    "name": "Belajar Pemrograman Java",
                    "priority": 3,
                    "tags": ["Java", "Pemrograman"]
                  }
                },
                "php": {
                  "description": "Example create todolist PHP",
                  "value": {
                    "name": "Belajar Pemrograman PHP",
                    "priority": 2,
                    "tags": ["PHP", "Pemrograman"]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Success create todolist",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Todolist"
                },
                "examples": {
                  "java": {
                    "description": "Success create Java todolist",
                    "value": {
                      "id": "1",
                      "name": "Java",
                      "priority": 3,
                      "tags": [
                        "Java",
                        "Pemrograman"
                      ]
                    }
                  },
                  "php": {
                    "description": "Success create PHP todolist",
                    "value": {
                      "id": "2",
                      "name": "PHP",
                      "priority": 2,
                      "tags": [
                        "PHP",
                        "Pemrograman"
                      ]
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/todolist/{todolistId}": {
      "put": {
        "tags": ["Todolist"],
        "summary": "Update existing todolist",
        "description": "Update existing todolist in database",
        "parameters": [
          {
            "$ref": "#/components/parameters/TodolistId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateOrUpdateTodolist"
              },
              "examples": {
                "java": {
                  "description": "Example create todolist Java",
                  "value": {
                    "name": "Belajar Pemrograman Java",
                    "priority": 3,
                    "tags": ["Java", "Pemrograman"]
                  }
                },
                "php": {
                  "description": "Example create todolist PHP",
                  "value": {
                    "name": "Belajar Pemrograman PHP",
                    "priority": 2,
                    "tags": ["PHP", "Pemrograman"]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Update todolist success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Todolist"
                },
                "examples": {
                  "java": {
                    "description": "Success update Java todolist",
                    "value": {
                      "id": "1",
                      "name": "Java",
                      "priority": 3,
                      "tags": [
                        "Java",
                        "Pemrograman"
                      ]
                    }
                  },
                  "php": {
                    "description": "Success update PHP todolist",
                    "value": {
                      "id": "2",
                      "name": "PHP",
                      "priority": 2,
                      "tags": [
                        "PHP",
                        "Pemrograman"
                      ]
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Todolist"],
        "summary": "Delete existing todolist",
        "description": "Delete existing todolist in database",
        "parameters": [
          {
            "$ref": "#/components/parameters/TodolistId"
          }
        ],
        "responses": {
          "204": {
            "description": "Delete todolist success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    }
                  }
                },
                "examples": {
                  "success": {
                    "description": "Success delete todolist",
                    "value": {
                      "success": true
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Failed not found todolist",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    }
                  }
                },
                "examples": {
                  "failed": {
                    "description": "Failed delete todolist",
                    "value": {
                      "success": false
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "parameters": {
      "TodolistId": {
        "name": "todolistId",
        "in": "path",
        "required": true,
        "description": "Todolist Id for update",
        "schema": {
          "type": "string",
          "maxLength": 100,
          "minLength": 1
        },
        "examples": {
          "java": {
            "description": "Sample todolist Id for Java",
            "value": "1"
          },
          "php": {
            "description": "Sample todolist Id for PHP",
            "value": "2"
          }
        }
      }
    },
    "schemas": {
      "Todolist": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "prioity": {
            "type": "number",
            "format": "int32"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "CreateOrUpdateTodolist": {
        "type": "object",
        "required": ["name", "priority"],
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "default": 1
          },
          "tags": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "string",
              "minLength": 1
            }
          }
        }
      },
      "ArrayTodolist": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/Todolist"
        }
      }
    }
  }
}
```


## 19 Security

* OpenAPI mendukung dokumentasi untuk Security RESTful api
* Dengan ini kita bisa memberitahu pengguna mekanisme Security apa yang kita gunakan di RESTful API kita
* Ada banyak format Security yang didukung oleh OpenAPI, seperti:
  * `apiKey` (query param, header, cookie)
  * `http` (basic auth, bearer token)
  * `oauth2`
  * `openIdConnect`
* Sebelum mengunakna fitur Security, kita perlu membuat requirement Security terlebih dahulu di Component, baru kita bisa gunakan di Operation
* <https://spec.openapis.org/oas/v3.0.3#security-scheme-object>
* <https://spec.openapis.org/oas/v3.0.3#security-requirement-object>

### Security Object

| Field Name       | Type               | Applies To     |          |
|------------------|--------------------|----------------|----------|
| type             | string             | Any            | REQUIRED |
| description      | string             | Any            |          |
| name             | string             | apiKey         | REQUIRED |
| in               | string             | apiKey         | REQUIRED |
| scheme           | string             | http           | REQUIRED |
| bearerFormat     | string             | http("bearer") |          |
| flows            | OAuth Flows Object | oauth2         | REQUIRED |
| openIdConnectUrl | string             | openIdConnect  | REQUIRED |

### Kode: Security

```json
{
  "components": {
    "securitySchemes": {
      "TodolistAuth": {
        "type": "apiKey",
          "in": "header",
          "name": "X-API-Key"
      }
    }
  }
}
```

### Kode: Security di Operation

```json
{
  "/todolist": {
    "get": {
      "security": [
        {
          "TodolistAuth": []
        }
      ]
    },
    "post": {
      "security": [
        {
          "TodolistAuth": []
        }
      ]
    }
  },
  "/todolist/{todolistId}": {
    "put": {
      "security": [
        {
          "TodolistAuth": []
        }
      ]
    },
    "delete": {
      "security": [
        {
          "TodolistAuth": []
        }
      ]
    }
  }
}
```


## 20 Code Generator

* OpenAPi adalah spesifikasi yang standard, dan banyak diadopsi oleh banyak perusahaan
* Bahkan kita bisa melakukan code generator sesuai dengan bahasa pemrograman yang kita inginkan
* Contohnya kita bisa menggunakan <https://editor.swagger.io/> untuk membuat code client atau server sesuai dengan OpenAPI file yang kita buat
* Hal ini bisa mempermudah ketika kita butuh membuat kode client atau server yang sesuai dengan OpenAPI spec yang sudah dibuat


## 21 Penutup

* Masih banyak fitur yang terdapat di OpenAPI, silahkan pelajari langsung di halaman websitenya
* Mulai sekarang selalu gunakan OpenAPI untuk membuat dokumentasi RESTful API
* Buatlah OpenAPI sebelum kita membuat aplikasi RESTful API
* OpenAPI bisa digunakan sebagai kontrak kesepakatan antara yang akan membuat RESTful API dan yang akan menggunakan RESTful API


## FULL CONFIG

```json
{
  "openapi": "3.0.3",
  "info": {
    "title": "TodoList RESTful API",
    "description": "OpenAPI for TodoList RESTful API",
    "version": "1",
    "contact": {
      "name": "Eko Kurniawan Khannedy",
      "email": "echo.khannedy@gmail.com",
      "url": "https://www.programmerzamannow.com"
    },
    "license": {
      "name": "APACHE 2.0",
      "url": "https://www.apache.org/licenses/LICENSE-2.0"
    }
  },
  "servers": [
    {
      "url": "https://{environment}.programmerzamannow.com/api/v1",
      "description": "TodoList RESTful API Server",
      "variables": {
        "environment": {
          "default": "development",
          "description": "Server Environment",
          "enum": [
            "development",
            "staging",
            "production"
          ]
        }
      }
    }
  ],
  "externalDocs": {
    "description": "Youtube Programmer Zaman Now",
    "url": "https://www.youtube.com/c/ProgrammerZamanNow"
  },
  "paths": {
    "/todolist": {
      "get": {
        "security": [
          {
            "TodolistAuth": []
          }
        ],
        "tags": ["Todolist"],
        "summary": "Get all todolist",
        "description": "Get all active todolist by default",
        "parameters": [
          {
            "name": "include_done",
            "in": "query",
            "required": false,
            "description": "Include done todolist in the result",
            "schema": {
              "type": "boolean",
              "default": false,
              "nullable": true
            }
          },
          {
            "name": "name",
            "in": "query",
            "required": false,
            "description": "Search todolist by name",
            "schema": {
              "type": "string",
              "nullable": true,
              "maxLength": 100,
              "minLength": 1
            },
            "examples": {
              "java": {
                "description": "Example name Java",
                "value": "Java"
              },
              "php": {
                "description": "Example name PHP",
                "value": "PHP"
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Success get all todolist",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ArrayTodolist"
                },
                "examples": {
                  "success": {
                    "description": "Example success get all todolist",
                    "value": [
                      {
                        "id": "1",
                        "name": "Java",
                        "priority": 3,
                        "tags": [
                          "Java",
                          "Pemrograman"
                        ]
                      },
                      {
                        "id": "2",
                        "name": "PHP",
                        "priority": 2,
                        "tags": [
                          "PHP",
                          "Pemrograman"
                        ]
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "security": [
          {
            "TodolistAuth": []
          }
        ],
        "tags": ["Todolist"],
        "summary": "Create new todolist",
        "description": "Create new active todolist",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateOrUpdateTodolist"
              },
              "examples": {
                "java": {
                  "description": "Example create todolist Java",
                  "value": {
                    "name": "Belajar Pemrograman Java",
                    "priority": 3,
                    "tags": ["Java", "Pemrograman"]
                  }
                },
                "php": {
                  "description": "Example create todolist PHP",
                  "value": {
                    "name": "Belajar Pemrograman PHP",
                    "priority": 2,
                    "tags": ["PHP", "Pemrograman"]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Success create todolist",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Todolist"
                },
                "examples": {
                  "java": {
                    "description": "Success create Java todolist",
                    "value": {
                      "id": "1",
                      "name": "Java",
                      "priority": 3,
                      "tags": [
                        "Java",
                        "Pemrograman"
                      ]
                    }
                  },
                  "php": {
                    "description": "Success create PHP todolist",
                    "value": {
                      "id": "2",
                      "name": "PHP",
                      "priority": 2,
                      "tags": [
                        "PHP",
                        "Pemrograman"
                      ]
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/todolist/{todolistId}": {
      "put": {
        "security": [
          {
            "TodolistAuth": []
          }
        ],
        "tags": ["Todolist"],
        "summary": "Update existing todolist",
        "description": "Update existing todolist in database",
        "parameters": [
          {
            "$ref": "#/components/parameters/TodolistId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateOrUpdateTodolist"
              },
              "examples": {
                "java": {
                  "description": "Example create todolist Java",
                  "value": {
                    "name": "Belajar Pemrograman Java",
                    "priority": 3,
                    "tags": ["Java", "Pemrograman"]
                  }
                },
                "php": {
                  "description": "Example create todolist PHP",
                  "value": {
                    "name": "Belajar Pemrograman PHP",
                    "priority": 2,
                    "tags": ["PHP", "Pemrograman"]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Update todolist success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Todolist"
                },
                "examples": {
                  "java": {
                    "description": "Success update Java todolist",
                    "value": {
                      "id": "1",
                      "name": "Java",
                      "priority": 3,
                      "tags": [
                        "Java",
                        "Pemrograman"
                      ]
                    }
                  },
                  "php": {
                    "description": "Success update PHP todolist",
                    "value": {
                      "id": "2",
                      "name": "PHP",
                      "priority": 2,
                      "tags": [
                        "PHP",
                        "Pemrograman"
                      ]
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "security": [
          {
            "TodolistAuth": []
          }
        ],
        "tags": ["Todolist"],
        "summary": "Delete existing todolist",
        "description": "Delete existing todolist in database",
        "parameters": [
          {
            "$ref": "#/components/parameters/TodolistId"
          }
        ],
        "responses": {
          "204": {
            "description": "Delete todolist success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    }
                  }
                },
                "examples": {
                  "success": {
                    "description": "Success delete todolist",
                    "value": {
                      "success": true
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Failed not found todolist",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    }
                  }
                },
                "examples": {
                  "failed": {
                    "description": "Failed delete todolist",
                    "value": {
                      "success": false
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "TodolistAuth": {
        "description": "Authentication for Todolist RESTful API",
        "type": "apiKey",
        "in": "header",
        "name": "X-API-Key"
      }
    },
    "parameters": {
      "TodolistId": {
        "name": "todolistId",
        "in": "path",
        "required": true,
        "description": "Todolist Id for update",
        "schema": {
          "type": "string",
          "maxLength": 100,
          "minLength": 1
        },
        "examples": {
          "java": {
            "description": "Sample todolist Id for Java",
            "value": "1"
          },
          "php": {
            "description": "Sample todolist Id for PHP",
            "value": "2"
          }
        }
      }
    },
    "schemas": {
      "Todolist": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "prioity": {
            "type": "number",
            "format": "int32"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "CreateOrUpdateTodolist": {
        "type": "object",
        "required": ["name", "priority"],
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "default": 1
          },
          "tags": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "string",
              "minLength": 1
            }
          }
        }
      },
      "ArrayTodolist": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/Todolist"
        }
      }
    }
  }
}
```
