# 2023-09-03-16-25-26 Rails: Change attribute name in collection of object

Saya memiliki method **geofences** yang mengembalikan *colllection of* `hash` data dari model **geofeonce**.

Model **geofence** memiliki attributes,

```
:id, :created_at, :updated_at, :name, :description, :coordinates, :incoming_notification, :outgoing_notification
```

Saya hanya ingin mengambil attributes: `:id`, `:incoming_notification`, `:outgoing_notification`.

```ruby
def geofences
  {
    geofences: Geofence.all.order(id: :asc).as_json(only: [:id, :incoming_notification, :outgoing_notification])
  }
end
```

Outputnya,

```json
{
    "geofences": [
        {
            "id": 1,
            "incoming_notification": true,
            "outgoing_notification": false
        },
        {
            "id": 2,
            "incoming_notification": false,
            "outgoing_notification": true
        },
        {
            "id": 3,
            "incoming_notification": true,
            "outgoing_notification": false
        },
        {
            "id": 4,
            "incoming_notification": false,
            "outgoing_notification": true
        }
    ]
}
```

Karena nama attribute `:incoming_notification` dan `:outgoing_notification` terlalu panjang, saya akan ganti menjadi `:in` dan `:out`. [^1]

```ruby
def geofences
  {
    geofences: Geofence.all.order(id: :asc)
      .as_json(only: [:id, :incoming_notification, :outgoing_notification])
      .each { |attribute|
        attribute.tap { |key|
          key[:in] = key.delete('incoming_notification')
          key[:out] = key.delete('outgoing_notification')
        }
      }
  }
end
```

Hasilnya,

```json
{
    "geofences": [
        {
            "id": 1,
            "in": true,
            "out": false
        },
        {
            "id": 2,
            "in": false,
            "out": true
        },
        {
            "id": 3,
            "in": true,
            "out": false
        },
        {
            "id": 4,
            "in": false,
            "out": true
        }
    ]
}
```


[^1]: [stackoverflow.com: _Change property name of as_json call_](https://stackoverflow.com/a/33528446/4862516)
